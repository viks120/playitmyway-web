<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#2c3e50">
  <title>Free Minesweeper Game Online | Play It My Way</title>
  <meta name="description" content="Play classic Minesweeper game online for free! Three difficulty levels. Train your logic skills. No download required!">
  <style>
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body {
      font-family: "Comic Sans MS", "Arial Rounded MT Bold", Arial, sans-serif;
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      margin: 0; padding: 10px; min-height: 100vh;
      display: flex; flex-direction: column; align-items: center;
    }
    .back-link {
      position: absolute; top: 15px; left: 15px; color: white;
      text-decoration: none; font-size: 1em;
      background: rgba(255,255,255,0.2); padding: 8px 12px;
      border-radius: 20px; z-index: 100;
    }
    .back-link:hover { background: rgba(255,255,255,0.3); }
    .header { text-align: center; color: white; margin-bottom: 15px; }
    .header h1 { font-size: clamp(1.5em, 5vw, 2em); margin: 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
    .stats {
      display: flex; gap: 20px; margin-bottom: 15px; color: white;
      font-size: 1.2em; font-weight: bold;
    }
    .difficulty-selector { margin-bottom: 15px; }
    .diff-btn {
      background: linear-gradient(45deg, #e74c3c, #c0392b); color: white;
      border: none; padding: 8px 18px; border-radius: 20px;
      font-size: 1em; font-weight: bold; cursor: pointer; margin: 3px;
    }
    .diff-btn.active { background: linear-gradient(45deg, #27ae60, #2ecc71); transform: scale(1.05); }
    .game-container {
      background: rgba(255,255,255,0.95); border-radius: 15px;
      padding: 20px; box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    }
    .grid {
      display: grid; gap: 2px; margin: 0 auto;
      background: #7f8c8d; padding: 5px; border-radius: 5px;
    }
    .cell {
      width: 30px; height: 30px; background: #bdc3c7;
      border: 2px outset #ecf0f1; display: flex;
      align-items: center; justify-content: center;
      font-weight: bold; font-size: 14px; cursor: pointer;
      user-select: none;
    }
    .cell.revealed { background: #ecf0f1; border: 1px solid #95a5a6; }
    .cell.mine { background: #e74c3c; }
    .cell.flagged::after { content: "üö©"; }
    .cell.revealed.mine::after { content: "üí£"; }
    .cell[data-num="1"] { color: #3498db; }
    .cell[data-num="2"] { color: #27ae60; }
    .cell[data-num="3"] { color: #e74c3c; }
    .cell[data-num="4"] { color: #9b59b6; }
    .cell[data-num="5"] { color: #e67e22; }
    .cell[data-num="6"] { color: #1abc9c; }
    .cell[data-num="7"] { color: #2c3e50; }
    .cell[data-num="8"] { color: #7f8c8d; }
    .controls { margin-top: 15px; text-align: center; }
    .btn {
      background: linear-gradient(45deg, #3498db, #2980b9); color: white;
      border: none; padding: 12px 24px; border-radius: 25px;
      font-size: 1.1em; font-weight: bold; cursor: pointer; margin: 5px;
    }
    .btn:hover { transform: scale(1.05); }
    .modal-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.7); display: none;
      justify-content: center; align-items: center; z-index: 1000;
    }
    .modal-overlay.show { display: flex; }
    .modal {
      background: white; border-radius: 20px; padding: 30px;
      text-align: center; max-width: 350px; width: 90%;
    }
    .modal h2 { font-size: 1.8em; margin-bottom: 10px; }
    .modal p { font-size: 1.2em; color: #666; }
    .modal-btn {
      background: linear-gradient(45deg, #27ae60, #2ecc71); color: white;
      border: none; padding: 12px 25px; border-radius: 25px;
      font-size: 1.1em; font-weight: bold; cursor: pointer; margin: 5px;
    }
    .stars { font-size: 2.5em; margin: 10px 0; }
    .star { color: #ddd; }
    .star.filled { color: #f1c40f; }
    .confetti {
      position: fixed; width: 10px; height: 10px; top: -10px; z-index: 1001;
      animation: confettiFall 3s linear forwards;
    }
    @keyframes confettiFall {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }
    @media (max-width: 480px) {
      .cell { width: 25px; height: 25px; font-size: 12px; }
      .back-link { top: 5px; left: 5px; padding: 5px 8px; font-size: 0.8em; }
    }
  </style>
</head>
<body>
  <a href="../../" class="back-link">‚Üê Back to Games</a>
  <div class="header"><h1>üí£ Minesweeper</h1></div>
  <div class="stats">
    <div>üí£ Mines: <span id="mineCount">10</span></div>
    <div>‚è±Ô∏è Time: <span id="timer">0</span>s</div>
    <div>üèÜ Best: <span id="best">-</span>s</div>
  </div>
  <div class="difficulty-selector">
    <button class="diff-btn active" onclick="setDifficulty('easy')">Easy (9√ó9)</button>
    <button class="diff-btn" onclick="setDifficulty('medium')">Medium (16√ó16)</button>
    <button class="diff-btn" onclick="setDifficulty('hard')">Hard (16√ó30)</button>
  </div>
  <div class="game-container">
    <div class="grid" id="grid"></div>
    <div class="controls">
      <button class="btn" onclick="newGame()">üîÑ New Game</button>
      <button class="btn" id="flagBtn" onclick="toggleFlagMode()">üö© Flag Mode: OFF</button>
    </div>
  </div>
  <div class="modal-overlay" id="modal">
    <div class="modal">
      <h2 id="modalTitle">üéâ You Win!</h2>
      <div class="stars" id="starRating"><span class="star">‚òÖ</span><span class="star">‚òÖ</span><span class="star">‚òÖ</span></div>
      <p id="modalMsg">Great job!</p>
      <button class="modal-btn" onclick="closeModal()">Play Again</button>
    </div>
  </div>
  <script>

    const AudioContext = window.AudioContext || window.webkitAudioContext;
    let audioCtx = null;
    function initAudio() { if (!audioCtx) audioCtx = new AudioContext(); }
    function playSound(type) {
      initAudio();
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.connect(gain); gain.connect(audioCtx.destination);
      if (type === 'click') {
        osc.frequency.setValueAtTime(600, audioCtx.currentTime);
        gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gain.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.05);
        osc.start(); osc.stop(audioCtx.currentTime + 0.05);
      } else if (type === 'explode') {
        osc.type = 'sawtooth';
        osc.frequency.setValueAtTime(200, audioCtx.currentTime);
        osc.frequency.linearRampToValueAtTime(50, audioCtx.currentTime + 0.3);
        gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
        gain.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
        osc.start(); osc.stop(audioCtx.currentTime + 0.3);
      } else if (type === 'win') {
        [523, 659, 784, 1047].forEach((f, i) => {
          const o = audioCtx.createOscillator();
          const g = audioCtx.createGain();
          o.connect(g); g.connect(audioCtx.destination);
          o.frequency.setValueAtTime(f, audioCtx.currentTime + i * 0.1);
          g.gain.setValueAtTime(0.1, audioCtx.currentTime + i * 0.1);
          g.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + i * 0.1 + 0.2);
          o.start(audioCtx.currentTime + i * 0.1);
          o.stop(audioCtx.currentTime + i * 0.1 + 0.2);
        });
      }
    }
    function createConfetti() {
      const colors = ['#e74c3c', '#3498db', '#f1c40f', '#2ecc71', '#9b59b6'];
      for (let i = 0; i < 40; i++) {
        const c = document.createElement('div');
        c.className = 'confetti';
        c.style.left = Math.random() * 100 + 'vw';
        c.style.background = colors[Math.floor(Math.random() * colors.length)];
        c.style.animationDelay = Math.random() * 1.5 + 's';
        document.body.appendChild(c);
        setTimeout(() => c.remove(), 4000);
      }
    }

    const configs = {
      easy: { rows: 9, cols: 9, mines: 10 },
      medium: { rows: 16, cols: 16, mines: 40 },
      hard: { rows: 16, cols: 30, mines: 99 }
    };
    let difficulty = 'easy';
    let grid = [], rows, cols, mines, revealed = 0, flagged = 0;
    let gameOver = false, firstClick = true, flagMode = false;
    let timerInterval, seconds = 0;
    let best = JSON.parse(localStorage.getItem('minesweeper_best') || '{}');

    function setDifficulty(d) {
      difficulty = d;
      document.querySelectorAll('.diff-btn').forEach(b => b.classList.remove('active'));
      event.target.classList.add('active');
      newGame();
    }

    function newGame() {
      const cfg = configs[difficulty];
      rows = cfg.rows; cols = cfg.cols; mines = cfg.mines;
      grid = []; revealed = 0; flagged = 0; gameOver = false; firstClick = true;
      clearInterval(timerInterval); seconds = 0;
      document.getElementById('timer').textContent = '0';
      document.getElementById('mineCount').textContent = mines;
      updateBest();
      const gridEl = document.getElementById('grid');
      gridEl.style.gridTemplateColumns = `repeat(${cols}, 30px)`;
      gridEl.innerHTML = '';
      for (let r = 0; r < rows; r++) {
        grid[r] = [];
        for (let c = 0; c < cols; c++) {
          grid[r][c] = { mine: false, revealed: false, flagged: false, num: 0 };
          const cell = document.createElement('div');
          cell.className = 'cell';
          cell.dataset.r = r; cell.dataset.c = c;
          cell.addEventListener('click', () => handleClick(r, c));
          cell.addEventListener('contextmenu', (e) => { e.preventDefault(); toggleFlag(r, c); });
          gridEl.appendChild(cell);
        }
      }
    }

    function placeMines(excludeR, excludeC) {
      let placed = 0;
      while (placed < mines) {
        const r = Math.floor(Math.random() * rows);
        const c = Math.floor(Math.random() * cols);
        if (!grid[r][c].mine && !(r === excludeR && c === excludeC)) {
          grid[r][c].mine = true; placed++;
        }
      }
      for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols; c++) {
          if (!grid[r][c].mine) {
            let count = 0;
            for (let dr = -1; dr <= 1; dr++) {
              for (let dc = -1; dc <= 1; dc++) {
                const nr = r + dr, nc = c + dc;
                if (nr >= 0 && nr < rows && nc >= 0 && nc < cols && grid[nr][nc].mine) count++;
              }
            }
            grid[r][c].num = count;
          }
        }
      }
    }

    function handleClick(r, c) {
      if (gameOver || grid[r][c].flagged) return;
      if (flagMode) { toggleFlag(r, c); return; }
      if (firstClick) {
        firstClick = false;
        placeMines(r, c);
        timerInterval = setInterval(() => {
          seconds++;
          document.getElementById('timer').textContent = seconds;
        }, 1000);
      }
      if (grid[r][c].mine) {
        gameOver = true; clearInterval(timerInterval);
        revealAll(); playSound('explode');
        showModal(false);
      } else {
        reveal(r, c); playSound('click');
        checkWin();
      }
    }

    function reveal(r, c) {
      if (r < 0 || r >= rows || c < 0 || c >= cols) return;
      if (grid[r][c].revealed || grid[r][c].flagged) return;
      grid[r][c].revealed = true; revealed++;
      const cell = document.querySelector(`.cell[data-r="${r}"][data-c="${c}"]`);
      cell.classList.add('revealed');
      if (grid[r][c].num > 0) {
        cell.textContent = grid[r][c].num;
        cell.dataset.num = grid[r][c].num;
      } else {
        for (let dr = -1; dr <= 1; dr++) {
          for (let dc = -1; dc <= 1; dc++) {
            reveal(r + dr, c + dc);
          }
        }
      }
    }

    function toggleFlag(r, c) {
      if (gameOver || grid[r][c].revealed) return;
      const cell = document.querySelector(`.cell[data-r="${r}"][data-c="${c}"]`);
      grid[r][c].flagged = !grid[r][c].flagged;
      cell.classList.toggle('flagged');
      flagged += grid[r][c].flagged ? 1 : -1;
      document.getElementById('mineCount').textContent = mines - flagged;
    }

    function toggleFlagMode() {
      flagMode = !flagMode;
      document.getElementById('flagBtn').textContent = `üö© Flag Mode: ${flagMode ? 'ON' : 'OFF'}`;
    }

    function revealAll() {
      for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols; c++) {
          if (grid[r][c].mine) {
            const cell = document.querySelector(`.cell[data-r="${r}"][data-c="${c}"]`);
            cell.classList.add('revealed', 'mine');
          }
        }
      }
    }

    function checkWin() {
      if (revealed === rows * cols - mines) {
        gameOver = true; clearInterval(timerInterval);
        playSound('win'); createConfetti();
        if (!best[difficulty] || seconds < best[difficulty]) {
          best[difficulty] = seconds;
          localStorage.setItem('minesweeper_best', JSON.stringify(best));
          updateBest();
        }
        showModal(true);
      }
    }

    function updateBest() {
      document.getElementById('best').textContent = best[difficulty] ? best[difficulty] : '-';
    }

    function showModal(won) {
      document.getElementById('modalTitle').textContent = won ? 'üéâ You Win!' : 'üí• Game Over!';
      document.getElementById('modalMsg').textContent = won ? `Time: ${seconds}s` : 'You hit a mine!';
      const stars = document.querySelectorAll('#starRating .star');
      const starCount = won ? (seconds < 60 ? 3 : seconds < 120 ? 2 : 1) : 0;
      stars.forEach((s, i) => s.classList.toggle('filled', i < starCount));
      document.getElementById('modal').classList.add('show');
    }

    function closeModal() {
      document.getElementById('modal').classList.remove('show');
      newGame();
    }

    newGame();
  </script>
</body>
</html>