<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <meta name="theme-color" content="#667eea" />
    <meta name="apple-mobile-web-app-capable" content="yes" />

    <!-- SEO Meta Tags -->
    <title>
      Word Scramble Game for Kids - Free Vocabulary Game | Play It My Way
    </title>
    <meta
      name="description"
      content="Free word scramble game for kids ages 10+. Unscramble letters to form words, improve vocabulary and spelling skills. Educational word puzzle game."
    />
    <meta
      name="keywords"
      content="word scramble, vocabulary games, spelling games, educational games, word puzzles, kids word games, free word games, letter scramble, word building, educational activities"
    />
    <meta name="author" content="Play It My Way" />
    <meta name="robots" content="index, follow" />

    <!-- Open Graph Meta Tags -->
    <meta
      property="og:title"
      content="Word Scramble Game for Kids - Free Vocabulary Game"
    />
    <meta
      property="og:description"
      content="Fun word scramble game for children. Unscramble letters to form words and improve vocabulary skills."
    />
    <meta property="og:type" content="game" />
    <meta
      property="og:url"
      content="https://playitmyway.com/games/word-scramble"
    />
    <meta
      property="og:image"
      content="https://playitmyway.com/images/word-scramble.jpg"
    />

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Word Scramble Game for Kids" />
    <meta
      name="twitter:description"
      content="Free word puzzle game for children. Improve vocabulary and spelling skills."
    />
    <meta
      name="twitter:image"
      content="https://playitmyway.com/images/word-scramble.jpg"
    />

    <!-- Additional SEO Meta Tags -->
    <meta name="language" content="English" />
    <meta name="classification" content="Educational Word Game" />
    <link rel="canonical" href="https://playitmyway.com/games/word-scramble" />

    <style>
      * {
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
      }

      body {
        font-family: "Comic Sans MS", "Arial Rounded MT Bold", "Arial",
          sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        margin: 0;
        padding: 10px;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        overflow-x: hidden;
        font-size: 18px;
        line-height: 1.6;
      }

      .header {
        text-align: center;
        color: white;
        margin-bottom: 25px;
      }

      .header h1 {
        font-size: clamp(2em, 7vw, 2.5em);
        font-weight: bold;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        margin-bottom: 10px;
      }

      .header p {
        font-size: clamp(1.2em, 4vw, 1.4em);
        font-weight: 500;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
      }

      .stats {
        display: flex;
        gap: 25px;
        margin-bottom: 25px;
        color: white;
        font-size: clamp(1.1em, 4vw, 1.3em);
        font-weight: bold;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
      }

      .difficulty-selector {
        margin-bottom: 25px;
        text-align: center;
      }

      .difficulty-selector h3 {
        font-size: clamp(1.3em, 5vw, 1.6em);
        color: white;
        font-weight: bold;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        margin-bottom: 15px;
      }

      .difficulty-btn {
        background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 25px;
        font-size: clamp(1em, 4vw, 1.2em);
        font-weight: bold;
        cursor: pointer;
        margin: 0 12px;
        transition: transform 0.2s;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
      }

      .difficulty-btn.active {
        background: linear-gradient(45deg, #4ecdc4, #44a08d);
        transform: scale(1.05);
      }

      .difficulty-btn:hover {
        transform: scale(1.05);
      }

      .game-container {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        max-width: 600px;
        width: 100%;
      }

      .word-info {
        text-align: center;
        margin-bottom: 20px;
      }

      .category {
        font-size: clamp(1.2em, 4vw, 1.5em);
        color: #333;
        font-weight: bold;
        margin-bottom: 10px;
      }

      .hint {
        font-size: clamp(1em, 3vw, 1.2em);
        color: #666;
        font-style: italic;
        margin-bottom: 15px;
      }

      .scrambled-letters {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-bottom: 30px;
        flex-wrap: wrap;
      }

      .letter-tile {
        width: 50px;
        height: 50px;
        background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
        color: white;
        border: 3px solid #333;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5em;
        font-weight: bold;
        cursor: grab;
        transition: all 0.3s ease;
        user-select: none;
        touch-action: manipulation;
      }

      .letter-tile:hover {
        transform: scale(1.1);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      }

      .letter-tile.dragging {
        opacity: 0.5;
        transform: scale(1.1);
      }

      .answer-area {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-bottom: 30px;
        min-height: 60px;
        border: 3px dashed #ccc;
        border-radius: 10px;
        padding: 10px;
        background: rgba(255, 255, 255, 0.5);
      }

      .answer-slot {
        width: 50px;
        height: 50px;
        border: 2px dashed #999;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 255, 255, 0.3);
      }

      .answer-slot.filled {
        border-color: #4ecdc4;
        background: rgba(78, 205, 196, 0.2);
      }

      .controls {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-bottom: 20px;
      }

      .btn {
        background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 25px;
        font-size: clamp(1em, 4vw, 1.2em);
        font-weight: bold;
        cursor: pointer;
        margin: 0 12px;
        transition: transform 0.2s;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
      }

      .btn:hover {
        transform: scale(1.05);
      }

      .feedback {
        text-align: center;
        font-size: clamp(1.2em, 5vw, 1.5em);
        font-weight: bold;
        margin: 20px 0;
        padding: 15px;
        border-radius: 12px;
        display: none;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
      }

      .feedback.correct {
        background: #a8e6cf;
        color: #2d5a3d;
      }

      .feedback.incorrect {
        background: #ff6b6b;
        color: white;
      }

      .back-link {
        position: absolute;
        top: 20px;
        left: 20px;
        color: white;
        text-decoration: none;
        font-size: clamp(0.9em, 3vw, 1em);
        background: rgba(255, 255, 255, 0.2);
        padding: 8px 12px;
        border-radius: 20px;
        transition: background 0.3s;
      }

      .back-link:hover {
        background: rgba(255, 255, 255, 0.3);
      }

      /* Mobile-specific improvements */
      @media (max-width: 768px) {
        body {
          padding-top: 60px; /* Space for back link */
        }

        .game-container {
          padding: 15px;
          margin: 0 5px;
        }

        .letter-tile {
          width: 45px;
          height: 45px;
          font-size: 1.3em;
        }

        .answer-slot {
          width: 45px;
          height: 45px;
        }

        .controls {
          flex-direction: column;
          align-items: center;
          gap: 10px;
        }

        .btn {
          margin: 5px 0;
        }

        .difficulty-selector {
          margin-bottom: 20px;
        }

        .difficulty-btn {
          display: block;
          margin: 8px auto;
          width: 200px;
          max-width: 90%;
        }
      }

      @media (max-width: 480px) {
        body {
          padding-top: 50px; /* Less space on smaller screens */
        }

        .letter-tile {
          width: 40px;
          height: 40px;
          font-size: 1.2em;
        }

        .answer-slot {
          width: 40px;
          height: 40px;
        }

        .scrambled-letters {
          gap: 8px;
        }

        .answer-area {
          gap: 8px;
        }

        .difficulty-btn {
          width: 180px;
          font-size: clamp(0.9em, 3.5vw, 1.1em);
          padding: 10px 20px;
        }

        .stats {
          flex-direction: column;
          gap: 10px;
          align-items: center;
        }
      }

      /* Prevent text selection on mobile */
      .letter-tile,
      .difficulty-btn,
      .btn {
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        touch-action: manipulation;
      }

      /* Modal Styles */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        animation: fadeIn 0.3s ease;
      }

      .modal-overlay.show {
        display: flex;
      }

      .modal {
        background: white;
        border-radius: 20px;
        padding: 30px;
        text-align: center;
        max-width: 400px;
        width: 90%;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        animation: scaleIn 0.3s ease;
      }

      .modal h2 {
        font-size: 2em;
        margin-bottom: 15px;
        color: #333;
      }

      .modal .stats-display {
        background: linear-gradient(45deg, #a8e6cf, #88d8c0);
        padding: 15px;
        border-radius: 10px;
        margin: 15px 0;
      }

      .modal .stats-display p {
        margin: 5px 0;
        color: #2d5a3d;
        font-weight: bold;
        font-size: 1.1em;
      }

      .modal .high-score {
        color: #ff6b6b;
        font-weight: bold;
        font-size: 1.2em;
      }

      .modal-btn {
        background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 25px;
        font-size: 1.1em;
        font-weight: bold;
        cursor: pointer;
        margin: 10px;
        transition: transform 0.2s;
      }

      .modal-btn:hover {
        transform: scale(1.05);
      }

      .modal-close {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 1.5em;
        color: #999;
        cursor: pointer;
        line-height: 1;
      }

      .modal-close:hover {
        color: #333;
      }

      .modal {
        position: relative;
      }

      /* Confetti */
      .confetti {
        position: fixed;
        width: 10px;
        height: 10px;
        top: -10px;
        z-index: 1001;
        animation: confettiFall 3s linear forwards;
      }

      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }

      @keyframes scaleIn {
        from { transform: scale(0.8); opacity: 0; }
        to { transform: scale(1); opacity: 1; }
      }

      @keyframes confettiFall {
        0% { transform: translateY(0) rotate(0deg); opacity: 1; }
        100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
      }

      /* Star Rating */
      .stars {
        font-size: 2.5em;
        margin: 10px 0;
      }

      .star {
        color: #ddd;
        transition: color 0.3s;
      }

      .star.filled {
        color: #ffd700;
      }

      /* Streak indicator */
      .streak-indicator {
        background: linear-gradient(45deg, #ffd700, #ffaa00);
        color: white;
        padding: 5px 15px;
        border-radius: 20px;
        font-weight: bold;
        display: none;
        animation: pulse 0.5s ease;
      }

      .streak-indicator.show {
        display: inline-block;
      }

      @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
      }
    </style>
  </head>
  <body>
    <a href="../../" class="back-link">‚Üê Back to Games</a>

    <div class="header">
      <h1>üî§ Word Scramble</h1>
      <p>Unscramble the letters to form words!</p>
    </div>

    <div class="stats">
      <div>Score: <span id="score">0</span></div>
      <div>Level: <span id="level">1</span></div>
      <div>Words Solved: <span id="solved">0</span></div>
      <div class="streak-indicator" id="streakIndicator">üî• Streak: <span id="streak">0</span></div>
    </div>

    <div class="difficulty-selector">
      <h3>Choose Difficulty:</h3>
      <button class="difficulty-btn active" onclick="setDifficulty('easy')">
        Easy (4 letters)
      </button>
      <button class="difficulty-btn" onclick="setDifficulty('medium')">
        Medium (5-6 letters)
      </button>
      <button class="difficulty-btn" onclick="setDifficulty('hard')">
        Hard (7+ letters)
      </button>
    </div>

    <div class="game-container">
      <div class="word-info">
        <div class="category" id="category">Category: Animals</div>
        <div class="hint" id="hint">Hint: A furry pet that says "meow"</div>
      </div>

      <div class="scrambled-letters" id="scrambledLetters">
        <!-- Letters will be generated here -->
      </div>

      <div class="answer-area" id="answerArea">
        <!-- Answer slots will be generated here -->
      </div>

      <div class="feedback" id="feedback"></div>

      <div class="controls">
        <button class="btn" onclick="checkAnswer()">Check Answer</button>
        <button class="btn" onclick="getHint()">Get Hint</button>
        <button class="btn" onclick="newWord()">New Word</button>
      </div>
    </div>

    <!-- Level Up Modal -->
    <div class="modal-overlay" id="levelModal" onclick="closeModalOnOverlay(event)">
      <div class="modal">
        <span class="modal-close" onclick="closeModal()">‚úï</span>
        <h2 id="modalTitle">üéä Level Up!</h2>
        <div class="stars" id="starRating">
          <span class="star">‚òÖ</span>
          <span class="star">‚òÖ</span>
          <span class="star">‚òÖ</span>
        </div>
        <div class="stats-display">
          <p>Score: <span id="modalScore">0</span></p>
          <p>Level: <span id="modalLevel">1</span></p>
          <p>Words Solved: <span id="modalSolved">0</span></p>
          <p>Best Streak: <span id="modalStreak">0</span></p>
        </div>
        <p id="highScoreMsg" class="high-score" style="display: none;">üèÜ New High Score!</p>
        <button class="modal-btn" onclick="closeModal()">Continue</button>
      </div>
    </div>

    <script>
      // Sound effects using Web Audio API
      const AudioContext = window.AudioContext || window.webkitAudioContext;
      let audioCtx = null;

      function initAudio() {
        if (!audioCtx) {
          audioCtx = new AudioContext();
        }
      }

      function playSound(type) {
        initAudio();
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        switch(type) {
          case 'correct':
            const notes = [523, 659, 784];
            notes.forEach((freq, i) => {
              const osc = audioCtx.createOscillator();
              const gain = audioCtx.createGain();
              osc.connect(gain);
              gain.connect(audioCtx.destination);
              osc.frequency.setValueAtTime(freq, audioCtx.currentTime + i * 0.1);
              osc.type = 'sine';
              gain.gain.setValueAtTime(0.15, audioCtx.currentTime + i * 0.1);
              gain.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + i * 0.1 + 0.2);
              osc.start(audioCtx.currentTime + i * 0.1);
              osc.stop(audioCtx.currentTime + i * 0.1 + 0.2);
            });
            return;
          case 'wrong':
            oscillator.frequency.setValueAtTime(200, audioCtx.currentTime);
            oscillator.frequency.setValueAtTime(150, audioCtx.currentTime + 0.1);
            oscillator.type = 'square';
            gainNode.gain.setValueAtTime(0.08, audioCtx.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.2);
            break;
          case 'levelUp':
            const levelNotes = [523, 659, 784, 1047];
            levelNotes.forEach((freq, i) => {
              const osc = audioCtx.createOscillator();
              const gain = audioCtx.createGain();
              osc.connect(gain);
              gain.connect(audioCtx.destination);
              osc.frequency.setValueAtTime(freq, audioCtx.currentTime + i * 0.15);
              osc.type = 'sine';
              gain.gain.setValueAtTime(0.15, audioCtx.currentTime + i * 0.15);
              gain.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + i * 0.15 + 0.3);
              osc.start(audioCtx.currentTime + i * 0.15);
              osc.stop(audioCtx.currentTime + i * 0.15 + 0.3);
            });
            return;
          case 'click':
            oscillator.frequency.setValueAtTime(500, audioCtx.currentTime);
            oscillator.type = 'sine';
            gainNode.gain.setValueAtTime(0.08, audioCtx.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.05);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.05);
            break;
        }
      }

      function createConfetti() {
        const colors = ['#ff6b6b', '#4ecdc4', '#ffd700', '#a8e6cf', '#ff9ff3', '#54a0ff'];
        for (let i = 0; i < 50; i++) {
          const confetti = document.createElement('div');
          confetti.className = 'confetti';
          confetti.style.left = Math.random() * 100 + 'vw';
          confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
          confetti.style.animationDelay = Math.random() * 2 + 's';
          confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
          document.body.appendChild(confetti);
          setTimeout(() => confetti.remove(), 5000);
        }
      }

      function displayStars(count) {
        const stars = document.querySelectorAll('#starRating .star');
        stars.forEach((star, i) => {
          star.classList.toggle('filled', i < count);
        });
      }

      function getHighScore(difficulty) {
        const key = `wordscramble_highscore_${difficulty}`;
        return parseInt(localStorage.getItem(key)) || 0;
      }

      function setHighScore(difficulty, score) {
        const key = `wordscramble_highscore_${difficulty}`;
        localStorage.setItem(key, score);
      }

      function showLevelModal() {
        const modal = document.getElementById('levelModal');
        document.getElementById('modalTitle').textContent = `üéä Level ${level}!`;
        document.getElementById('modalScore').textContent = score;
        document.getElementById('modalLevel').textContent = level;
        document.getElementById('modalSolved').textContent = wordsSolved;
        document.getElementById('modalStreak').textContent = bestStreak;

        const starCount = Math.min(3, level);
        displayStars(starCount);

        const highScore = getHighScore(currentDifficulty);
        const highScoreMsg = document.getElementById('highScoreMsg');
        if (score > highScore) {
          setHighScore(currentDifficulty, score);
          highScoreMsg.style.display = 'block';
        } else {
          highScoreMsg.style.display = 'none';
        }

        modal.classList.add('show');
        playSound('levelUp');
        createConfetti();
      }

      function closeModal() {
        document.getElementById('levelModal').classList.remove('show');
        newWord();
      }

      function closeModalOnOverlay(event) {
        if (event.target === event.currentTarget) {
          closeModal();
        }
      }
      let currentDifficulty = "easy";
      let currentWord = "";
      let scrambledLetters = [];
      let answerSlots = [];
      let score = 0;
      let level = 1;
      let wordsSolved = 0;
      let hintsUsed = 0;
      let streak = 0;
      let bestStreak = 0;

      const wordDatabase = {
        easy: [
          {
            word: "CAT",
            category: "Animals",
            hint: 'A furry pet that says "meow"',
          },
          {
            word: "DOG",
            category: "Animals",
            hint: 'A loyal pet that says "woof"',
          },
          {
            word: "SUN",
            category: "Nature",
            hint: "Bright star in the sky during day",
          },
          {
            word: "TREE",
            category: "Nature",
            hint: "Tall plant with leaves and branches",
          },
          {
            word: "BOOK",
            category: "Objects",
            hint: "Contains stories and knowledge",
          },
          {
            word: "CAKE",
            category: "Food",
            hint: "Sweet dessert for birthdays",
          },
          {
            word: "BALL",
            category: "Objects",
            hint: "Round object you can throw",
          },
          {
            word: "FISH",
            category: "Animals",
            hint: "Swims in water and has gills",
          },
        ],
        medium: [
          {
            word: "TIGER",
            category: "Animals",
            hint: "Large striped cat from the jungle",
          },
          {
            word: "PIZZA",
            category: "Food",
            hint: "Round food with cheese and toppings",
          },
          {
            word: "MUSIC",
            category: "Entertainment",
            hint: "Rhythmic sounds and melodies",
          },
          {
            word: "SPACE",
            category: "Science",
            hint: "The area beyond Earth's atmosphere",
          },
          {
            word: "OCEAN",
            category: "Nature",
            hint: "Large body of salt water",
          },
          {
            word: "SCHOOL",
            category: "Places",
            hint: "Where children go to learn",
          },
          {
            word: "FRIEND",
            category: "People",
            hint: "Someone you like and trust",
          },
          {
            word: "COLOUR",
            category: "Art",
            hint: "Red, blue, green, yellow, etc.",
          },
        ],
        hard: [
          {
            word: "ELEPHANT",
            category: "Animals",
            hint: "Large gray animal with a long trunk",
          },
          {
            word: "COMPUTER",
            category: "Technology",
            hint: "Electronic device for work and games",
          },
          {
            word: "MOUNTAIN",
            category: "Nature",
            hint: "Very tall natural elevation of land",
          },
          {
            word: "BUTTERFLY",
            category: "Animals",
            hint: "Colorful insect with large wings",
          },
          {
            word: "ADVENTURE",
            category: "Activities",
            hint: "Exciting journey or experience",
          },
          {
            word: "BEAUTIFUL",
            category: "Descriptions",
            hint: "Pleasant to look at",
          },
          {
            word: "HAPPINESS",
            category: "Emotions",
            hint: "Feeling of joy and contentment",
          },
          {
            word: "KNOWLEDGE",
            category: "Education",
            hint: "Information and understanding",
          },
        ],
      };

      function setDifficulty(difficulty) {
        currentDifficulty = difficulty;

        // Update active button
        document.querySelectorAll(".difficulty-btn").forEach((btn) => {
          btn.classList.remove("active");
        });
        event.target.classList.add("active");

        // Reset streak and start new word
        resetStreak();
        newWord();
      }

      function scrambleWord(word) {
        const letters = word.split("");
        for (let i = letters.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [letters[i], letters[j]] = [letters[j], letters[i]];
        }
        return letters.join("");
      }

      function createLetterTile(letter, index) {
        const tile = document.createElement("div");
        tile.className = "letter-tile";
        tile.textContent = letter;
        tile.draggable = true;
        tile.dataset.index = index;

        // Drag and drop functionality
        tile.addEventListener("dragstart", handleDragStart);
        tile.addEventListener("dragend", handleDragEnd);

        // Touch support for mobile
        tile.addEventListener("touchstart", handleTouchStart);
        tile.addEventListener("touchmove", handleTouchMove);
        tile.addEventListener("touchend", handleTouchEnd);

        return tile;
      }

      function createAnswerSlot(index) {
        const slot = document.createElement("div");
        slot.className = "answer-slot";
        slot.dataset.index = index;

        // Drop functionality
        slot.addEventListener("dragover", handleDragOver);
        slot.addEventListener("drop", handleDrop);

        // Touch support for mobile
        slot.addEventListener("touchstart", handleTouchStart);
        slot.addEventListener("touchmove", handleTouchMove);
        slot.addEventListener("touchend", handleTouchEnd);

        return slot;
      }

      function generateNewWord() {
        const words = wordDatabase[currentDifficulty];
        const randomIndex = Math.floor(Math.random() * words.length);
        const wordData = words[randomIndex];

        currentWord = wordData.word;
        document.getElementById(
          "category"
        ).textContent = `Category: ${wordData.category}`;
        document.getElementById("hint").textContent = `Hint: ${wordData.hint}`;

        // Clear previous letters and slots
        const scrambledContainer = document.getElementById("scrambledLetters");
        const answerContainer = document.getElementById("answerArea");

        scrambledContainer.innerHTML = "";
        answerContainer.innerHTML = "";

        // Create scrambled letters
        const scrambled = scrambleWord(currentWord);
        scrambledLetters = scrambled.split("").map((letter, index) => ({
          letter: letter,
          used: false,
          element: createLetterTile(letter, index),
        }));

        scrambledLetters.forEach((item) => {
          scrambledContainer.appendChild(item.element);
        });

        // Create answer slots
        answerSlots = currentWord.split("").map((letter, index) => ({
          letter: letter,
          filled: false,
          element: createAnswerSlot(index),
        }));

        answerSlots.forEach((slot) => {
          answerContainer.appendChild(slot.element);
        });

        // Clear feedback
        document.getElementById("feedback").style.display = "none";
      }

      function checkAnswer() {
        const currentAnswer = answerSlots
          .map((slot) => (slot.filled ? slot.currentLetter : ""))
          .join("");

        if (currentAnswer === currentWord) {
          // Correct answer
          playSound('correct');
          streak++;
          if (streak > bestStreak) bestStreak = streak;
          document.getElementById('streak').textContent = streak;
          if (streak >= 2) {
            document.getElementById('streakIndicator').classList.add('show');
          }

          const basePoints = currentWord.length * 10 - hintsUsed * 5;
          const streakBonus = streak >= 3 ? streak * 5 : 0;
          const points = basePoints + streakBonus;
          score += points;
          wordsSolved++;

          const previousLevel = level;
          if (wordsSolved >= level * 5) {
            level++;
          }

          updateStats();

          const feedbackText = streak >= 3 
            ? `üî• ${streak} in a row! +${points} points!` 
            : `üéâ Correct! +${points} points`;
          document.getElementById("feedback").textContent = feedbackText;
          document.getElementById("feedback").className = "feedback correct";
          document.getElementById("feedback").style.display = "block";

          if (level > previousLevel) {
            setTimeout(() => showLevelModal(), 1500);
          } else {
            setTimeout(() => {
              newWord();
            }, 2000);
          }
        } else {
          // Incorrect answer
          playSound('wrong');
          streak = 0;
          document.getElementById('streak').textContent = streak;
          document.getElementById('streakIndicator').classList.remove('show');
          document.getElementById("feedback").textContent = "üòÖ Try again!";
          document.getElementById("feedback").className = "feedback incorrect";
          document.getElementById("feedback").style.display = "block";

          setTimeout(() => {
            document.getElementById("feedback").style.display = "none";
          }, 2000);
        }
      }

      function getHint() {
        hintsUsed++;
        const hintElement = document.getElementById("hint");
        const currentHint = hintElement.textContent;

        // Show first letter as additional hint
        const firstLetter = currentWord[0];
        hintElement.textContent = `Hint: ${currentHint.replace(
          "Hint: ",
          ""
        )} (Starts with "${firstLetter}")`;
      }

      function newWord() {
        hintsUsed = 0;
        generateNewWord();
      }

      function resetStreak() {
        streak = 0;
        bestStreak = 0;
        document.getElementById('streak').textContent = 0;
        document.getElementById('streakIndicator').classList.remove('show');
      }

      function updateStats() {
        document.getElementById("score").textContent = score;
        document.getElementById("level").textContent = level;
        document.getElementById("solved").textContent = wordsSolved;
      }

      // Drag and Drop functionality
      let draggedElement = null;

      function handleDragStart(e) {
        draggedElement = this;
        this.classList.add("dragging");
      }

      function handleDragEnd(e) {
        this.classList.remove("dragging");
      }

      function handleDragOver(e) {
        e.preventDefault();
      }

      function handleDrop(e) {
        e.preventDefault();
        if (
          draggedElement &&
          draggedElement.classList.contains("letter-tile")
        ) {
          const letterIndex = parseInt(draggedElement.dataset.index);
          const slotIndex = parseInt(this.dataset.index);

          if (
            !answerSlots[slotIndex].filled &&
            !scrambledLetters[letterIndex].used
          ) {
            // Place letter in slot
            this.textContent = draggedElement.textContent;
            this.classList.add("filled");
            answerSlots[slotIndex].filled = true;
            answerSlots[slotIndex].currentLetter = draggedElement.textContent;
            scrambledLetters[letterIndex].used = true;
            draggedElement.style.display = "none";
          }
        }
      }

      // Touch functionality for mobile
      let touchStartX = 0;
      let touchStartY = 0;
      let touchElement = null;

      function handleTouchStart(e) {
        touchStartX = e.touches[0].clientX;
        touchStartY = e.touches[0].clientY;
        touchElement = this;
      }

      function handleTouchMove(e) {
        e.preventDefault();
      }

      function handleTouchEnd(e) {
        if (!touchElement) return;

        const touchEndX = e.changedTouches[0].clientX;
        const touchEndY = e.changedTouches[0].clientY;

        // Check if it's a tap (minimal movement)
        const deltaX = Math.abs(touchEndX - touchStartX);
        const deltaY = Math.abs(touchEndY - touchStartY);

        if (deltaX < 10 && deltaY < 10) {
          // Handle tap
          if (touchElement.classList.contains("letter-tile")) {
            // Find first empty slot
            const emptySlot = answerSlots.find((slot) => !slot.filled);
            if (emptySlot) {
              const letterIndex = parseInt(touchElement.dataset.index);
              if (!scrambledLetters[letterIndex].used) {
                emptySlot.element.textContent = touchElement.textContent;
                emptySlot.element.classList.add("filled");
                emptySlot.filled = true;
                emptySlot.currentLetter = touchElement.textContent;
                scrambledLetters[letterIndex].used = true;
                touchElement.style.display = "none";
              }
            }
          } else if (touchElement.classList.contains("answer-slot")) {
            // Remove letter from slot
            if (touchElement.classList.contains("filled")) {
              const slotIndex = parseInt(touchElement.dataset.index);
              const letter = answerSlots[slotIndex].currentLetter;

              // Find and restore the letter tile
              const letterTile = scrambledLetters.find(
                (item) => item.letter === letter && item.used
              );
              if (letterTile) {
                letterTile.used = false;
                letterTile.element.style.display = "flex";
              }

              // Clear slot
              touchElement.textContent = "";
              touchElement.classList.remove("filled");
              answerSlots[slotIndex].filled = false;
              answerSlots[slotIndex].currentLetter = "";
            }
          }
        }

        touchElement = null;
      }

      // Initialize game
      newWord();
    </script>
  </body>
</html>
