<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#667eea" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <title>Catch the Fruit - Play It My Way</title>
    <meta name="description" content="Free fruit catching game for kids ages 5+. Catch falling fruits in your basket. Fun and educational game for children." />
    <style>
      * {
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
        user-select: none;
      }

      body {
        font-family: "Comic Sans MS", "Arial Rounded MT Bold", "Arial", sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        margin: 0;
        padding: 10px;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        overflow: hidden;
      }

      .header {
        text-align: center;
        color: white;
        margin-bottom: 10px;
        z-index: 10;
      }

      .header h1 {
        font-size: clamp(1.5em, 5vw, 2em);
        font-weight: bold;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        margin: 0;
      }

      .stats {
        display: flex;
        gap: 20px;
        margin-bottom: 10px;
        color: white;
        font-size: clamp(1em, 3vw, 1.2em);
        font-weight: bold;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        z-index: 10;
      }

      .game-area {
        position: relative;
        width: 100%;
        max-width: 400px;
        height: 500px;
        background: linear-gradient(180deg, #87CEEB 0%, #98FB98 100%);
        border-radius: 15px;
        overflow: hidden;
        border: 4px solid #333;
        touch-action: none;
      }

      .basket {
        position: absolute;
        bottom: 10px;
        width: 80px;
        height: 60px;
        font-size: 50px;
        line-height: 60px;
        text-align: center;
        transition: left 0.05s linear;
      }

      .fruit {
        position: absolute;
        font-size: 40px;
        line-height: 40px;
        text-align: center;
        animation: fall linear forwards;
      }

      .bad-item {
        position: absolute;
        font-size: 35px;
        line-height: 35px;
        text-align: center;
        animation: fall linear forwards;
      }

      @keyframes fall {
        from { top: -50px; }
        to { top: 550px; }
      }

      .catch-effect {
        position: absolute;
        font-size: 24px;
        animation: floatUp 0.8s ease-out forwards;
        pointer-events: none;
        z-index: 100;
      }

      @keyframes floatUp {
        0% { opacity: 1; transform: translateY(0) scale(1); }
        100% { opacity: 0; transform: translateY(-50px) scale(1.5); }
      }

      .lives {
        position: absolute;
        top: 10px;
        right: 10px;
        font-size: 24px;
      }

      .controls {
        display: flex;
        gap: 10px;
        margin-top: 15px;
        z-index: 10;
      }

      .btn {
        background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 25px;
        font-size: clamp(1em, 3vw, 1.1em);
        font-weight: bold;
        cursor: pointer;
        transition: transform 0.2s;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
      }

      .btn:hover { transform: scale(1.05); }

      .back-link {
        position: absolute;
        top: 15px;
        left: 15px;
        color: white;
        text-decoration: none;
        font-size: clamp(0.9em, 3vw, 1em);
        background: rgba(255, 255, 255, 0.2);
        padding: 8px 12px;
        border-radius: 20px;
        z-index: 100;
      }

      .back-link:hover { background: rgba(255, 255, 255, 0.3); }

      /* Modal */
      .modal-overlay {
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: rgba(0, 0, 0, 0.7);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
      }

      .modal-overlay.show { display: flex; }

      .modal {
        background: white;
        border-radius: 20px;
        padding: 30px;
        text-align: center;
        max-width: 350px;
        width: 90%;
        animation: scaleIn 0.3s ease;
      }

      .modal h2 { font-size: 1.8em; margin-bottom: 10px; color: #333; }
      .modal p { font-size: 1.2em; color: #666; margin: 10px 0; }

      .stars { font-size: 2.5em; margin: 10px 0; }
      .star { color: #ddd; }
      .star.filled { color: #ffd700; }

      .high-score { color: #ff6b6b; font-weight: bold; }

      .modal-btn {
        background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 25px;
        font-size: 1.1em;
        font-weight: bold;
        cursor: pointer;
        margin: 5px;
      }

      .confetti {
        position: fixed;
        width: 10px; height: 10px;
        top: -10px;
        z-index: 1001;
        animation: confettiFall 3s linear forwards;
      }

      @keyframes scaleIn {
        from { transform: scale(0.8); opacity: 0; }
        to { transform: scale(1); opacity: 1; }
      }

      @keyframes confettiFall {
        0% { transform: translateY(0) rotate(0deg); opacity: 1; }
        100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
      }

      .start-screen {
        position: absolute;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        color: white;
        z-index: 50;
      }

      .start-screen h2 { font-size: 1.8em; margin-bottom: 20px; }
      .start-screen p { font-size: 1.1em; margin: 5px 0; }

      @media (max-width: 480px) {
        body { padding-top: 50px; }
        .game-area { height: 400px; max-width: 100%; }
        .basket { width: 70px; height: 50px; font-size: 40px; line-height: 50px; }
        .fruit { font-size: 35px; }
      }
    </style>
  </head>
  <body>
    <a href="../../" class="back-link">‚Üê Back to Games</a>

    <div class="header">
      <h1>üß∫ Catch the Fruit!</h1>
    </div>

    <div class="stats">
      <div>Score: <span id="score">0</span></div>
      <div>Level: <span id="level">1</span></div>
      <div>Best: <span id="best">0</span></div>
    </div>

    <div class="game-area" id="gameArea">
      <div class="lives" id="lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
      <div class="basket" id="basket">üß∫</div>
      <div class="start-screen" id="startScreen">
        <h2>üçé Catch the Fruit! üçä</h2>
        <p>Move the basket to catch fruits</p>
        <p>üçéüçäüçãüçáüçì = +10 points</p>
        <p>‚≠ê = +50 bonus!</p>
        <p>üí£ = Lose a life!</p>
        <br>
        <button class="btn" onclick="startGame()">Start Game</button>
      </div>
    </div>

    <div class="controls">
      <button class="btn" onclick="startGame()">New Game</button>
    </div>

    <div class="modal-overlay" id="modal">
      <div class="modal">
        <h2 id="modalTitle">Game Over!</h2>
        <div class="stars" id="starRating">
          <span class="star">‚òÖ</span>
          <span class="star">‚òÖ</span>
          <span class="star">‚òÖ</span>
        </div>
        <p>Score: <span id="finalScore">0</span></p>
        <p>Level: <span id="finalLevel">1</span></p>
        <p id="highScoreMsg" class="high-score" style="display: none;">üèÜ New High Score!</p>
        <button class="modal-btn" onclick="closeModal()">Play Again</button>
      </div>
    </div>

    <script>
      const AudioContext = window.AudioContext || window.webkitAudioContext;
      let audioCtx = null;

      function initAudio() {
        if (!audioCtx) audioCtx = new AudioContext();
      }

      function playSound(type) {
        initAudio();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);

        if (type === 'catch') {
          osc.frequency.setValueAtTime(600, audioCtx.currentTime);
          osc.frequency.setValueAtTime(800, audioCtx.currentTime + 0.05);
          gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
          gain.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
          osc.start(); osc.stop(audioCtx.currentTime + 0.1);
        } else if (type === 'bonus') {
          [800, 1000, 1200].forEach((f, i) => {
            const o = audioCtx.createOscillator();
            const g = audioCtx.createGain();
            o.connect(g); g.connect(audioCtx.destination);
            o.frequency.setValueAtTime(f, audioCtx.currentTime + i * 0.08);
            g.gain.setValueAtTime(0.12, audioCtx.currentTime + i * 0.08);
            g.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + i * 0.08 + 0.1);
            o.start(audioCtx.currentTime + i * 0.08);
            o.stop(audioCtx.currentTime + i * 0.08 + 0.1);
          });
        } else if (type === 'miss') {
          osc.frequency.setValueAtTime(200, audioCtx.currentTime);
          osc.type = 'square';
          gain.gain.setValueAtTime(0.08, audioCtx.currentTime);
          gain.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
          osc.start(); osc.stop(audioCtx.currentTime + 0.2);
        }
      }

      function createConfetti() {
        const colors = ['#ff6b6b', '#4ecdc4', '#ffd700', '#a8e6cf', '#ff9ff3'];
        for (let i = 0; i < 40; i++) {
          const c = document.createElement('div');
          c.className = 'confetti';
          c.style.left = Math.random() * 100 + 'vw';
          c.style.background = colors[Math.floor(Math.random() * colors.length)];
          c.style.animationDelay = Math.random() * 1.5 + 's';
          document.body.appendChild(c);
          setTimeout(() => c.remove(), 4000);
        }
      }

      const fruits = ['üçé', 'üçä', 'üçã', 'üçá', 'üçì', 'üçå', 'üçë', 'ü•ù'];
      const bonus = '‚≠ê';
      const bad = 'üí£';

      let score = 0, level = 1, lives = 3;
      let gameRunning = false;
      let spawnInterval, gameLoop;
      let basketX = 160;
      let best = parseInt(localStorage.getItem('catchfruit_best')) || 0;

      const gameArea = document.getElementById('gameArea');
      const basket = document.getElementById('basket');

      function updateDisplay() {
        document.getElementById('score').textContent = score;
        document.getElementById('level').textContent = level;
        document.getElementById('best').textContent = best;
        document.getElementById('lives').textContent = '‚ù§Ô∏è'.repeat(lives) + 'üñ§'.repeat(3 - lives);
      }

      function moveBasket(x) {
        const areaRect = gameArea.getBoundingClientRect();
        const maxX = areaRect.width - 80;
        basketX = Math.max(0, Math.min(maxX, x - 40));
        basket.style.left = basketX + 'px';
      }

      // Mouse/Touch controls
      gameArea.addEventListener('mousemove', (e) => {
        if (!gameRunning) return;
        const rect = gameArea.getBoundingClientRect();
        moveBasket(e.clientX - rect.left);
      });

      gameArea.addEventListener('touchmove', (e) => {
        if (!gameRunning) return;
        e.preventDefault();
        const rect = gameArea.getBoundingClientRect();
        moveBasket(e.touches[0].clientX - rect.left);
      });

      // Keyboard controls
      document.addEventListener('keydown', (e) => {
        if (!gameRunning) return;
        if (e.key === 'ArrowLeft') moveBasket(basketX - 20);
        if (e.key === 'ArrowRight') moveBasket(basketX + 60);
      });

      function spawnItem() {
        const areaRect = gameArea.getBoundingClientRect();
        const item = document.createElement('div');
        
        const rand = Math.random();
        let type, emoji;
        if (rand < 0.1) {
          type = 'bonus'; emoji = bonus;
        } else if (rand < 0.2) {
          type = 'bad'; emoji = bad;
        } else {
          type = 'fruit'; emoji = fruits[Math.floor(Math.random() * fruits.length)];
        }

        item.className = type === 'bad' ? 'bad-item' : 'fruit';
        item.textContent = emoji;
        item.dataset.type = type;
        item.style.left = Math.random() * (areaRect.width - 50) + 'px';
        
        const fallDuration = Math.max(2, 4 - level * 0.3);
        item.style.animationDuration = fallDuration + 's';

        gameArea.appendChild(item);

        item.addEventListener('animationend', () => {
          if (item.parentNode) {
            if (item.dataset.type !== 'bad') loseLife();
            item.remove();
          }
        });
      }

      function checkCollisions() {
        const basketRect = basket.getBoundingClientRect();
        const items = document.querySelectorAll('.fruit, .bad-item');

        items.forEach(item => {
          const itemRect = item.getBoundingClientRect();
          
          if (itemRect.bottom >= basketRect.top &&
              itemRect.top <= basketRect.bottom &&
              itemRect.right >= basketRect.left &&
              itemRect.left <= basketRect.right) {
            
            const type = item.dataset.type;
            item.remove();

            if (type === 'bad') {
              loseLife();
              showEffect(itemRect.left, itemRect.top, 'üí•');
            } else if (type === 'bonus') {
              score += 50;
              playSound('bonus');
              showEffect(itemRect.left, itemRect.top, '+50');
            } else {
              score += 10;
              playSound('catch');
              showEffect(itemRect.left, itemRect.top, '+10');
            }

            updateDisplay();
            checkLevelUp();
          }
        });
      }

      function showEffect(x, y, text) {
        const effect = document.createElement('div');
        effect.className = 'catch-effect';
        effect.textContent = text;
        effect.style.left = x + 'px';
        effect.style.top = y + 'px';
        effect.style.color = text.includes('+') ? '#4ecdc4' : '#ff6b6b';
        gameArea.appendChild(effect);
        setTimeout(() => effect.remove(), 800);
      }

      function loseLife() {
        lives--;
        playSound('miss');
        updateDisplay();
        if (lives <= 0) endGame();
      }

      function checkLevelUp() {
        const newLevel = Math.floor(score / 100) + 1;
        if (newLevel > level) {
          level = newLevel;
          updateDisplay();
        }
      }

      function startGame() {
        document.getElementById('startScreen').style.display = 'none';
        document.getElementById('modal').classList.remove('show');
        
        // Clear existing items
        document.querySelectorAll('.fruit, .bad-item').forEach(i => i.remove());
        
        score = 0; level = 1; lives = 3;
        gameRunning = true;
        basketX = gameArea.offsetWidth / 2 - 40;
        basket.style.left = basketX + 'px';
        updateDisplay();

        const spawnRate = () => Math.max(500, 1500 - level * 100);
        
        spawnInterval = setInterval(() => {
          if (gameRunning) spawnItem();
        }, 1000);

        gameLoop = setInterval(checkCollisions, 50);
      }

      function endGame() {
        gameRunning = false;
        clearInterval(spawnInterval);
        clearInterval(gameLoop);

        const isNewBest = score > best;
        if (isNewBest) {
          best = score;
          localStorage.setItem('catchfruit_best', best);
        }

        document.getElementById('finalScore').textContent = score;
        document.getElementById('finalLevel').textContent = level;
        document.getElementById('highScoreMsg').style.display = isNewBest ? 'block' : 'none';

        const stars = document.querySelectorAll('#starRating .star');
        const starCount = score >= 500 ? 3 : score >= 200 ? 2 : 1;
        stars.forEach((s, i) => s.classList.toggle('filled', i < starCount));

        document.getElementById('modal').classList.add('show');
        if (score >= 200) createConfetti();
      }

      function closeModal() {
        document.getElementById('modal').classList.remove('show');
        startGame();
      }

      updateDisplay();
    </script>
  </body>
</html>
